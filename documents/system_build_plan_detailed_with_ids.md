# ✅ システム構築計画（まちの掲示板） - タスク一覧

## 1. 準備フェーズ (ID: 1)
### 1.1 環境セットアップ
- [ ] **1.1.1** Node.js 20.xをインストール
- [ ] **1.1.2** パッケージマネージャ（npm/pnpm）準備
- [ ] **1.1.3** Next.jsプロジェクト作成（`create-next-app`）【前提: 1.1.1】
- [ ] **1.1.4** TypeScript, ESLint, Prettier設定【前提: 1.1.3】
- [ ] **1.1.5** Material UI, Emotion導入【前提: 1.1.3】
- [ ] **1.1.6** Leaflet + React-Leaflet導入【前提: 1.1.3】
- [ ] **1.1.7** `.env.local`を設定【前提: 1.1.3】

### 1.2 Supabase初期設定
- [ ] **1.2.1** Supabaseプロジェクト作成
- [ ] **1.2.2** Supabaseキー取得【前提: 1.2.1】
- [ ] **1.2.3** Supabase SDKをNext.jsに導入【前提: 1.1.3, 1.2.2】

---
## 2. データベース構築 (ID: 2)
### 2.1 スキーマ定義
- [ ] **2.1.1** profilesテーブル作成【前提: 1.2.1】
- [ ] **2.1.2** boardsテーブル作成【前提: 2.1.1】
- [ ] **2.1.3** photosテーブル作成【前提: 2.1.2】
- [ ] **2.1.4** commentsテーブル作成【前提: 2.1.2】
- [ ] **2.1.5** likesテーブル作成【前提: 2.1.2】

### 2.2 拡張設定
- [ ] **2.2.1** PostGIS / earthdistance拡張有効化【前提: 2.1.2】
- [ ] **2.2.2** Supabase Storageで`photos`バケット作成【前提: 1.2.1】

### 2.3 セキュリティ
- [ ] **2.3.1** RLS設定（profiles）【前提: 2.1.1】
- [ ] **2.3.2** RLS設定（boards/photos）【前提: 2.1.2, 2.1.3】
- [ ] **2.3.3** 3日以内再投稿不可ポリシー設定【前提: 2.1.3】

---
## 3. バックエンド(API)実装 (ID: 3)
### 3.1 認証API
- [ ] **3.1.1** `/api/auth/signup`実装【前提: 1.2.3】
- [ ] **3.1.2** `/api/auth/login`実装【前提: 1.2.3】

### 3.2 掲示板API
- [ ] **3.2.1** GET `/api/boards`【前提: 2.1.2】
- [ ] **3.2.2** POST `/api/boards`（EXIF解析）【前提: 2.1.2, 2.1.3】

### 3.3 写真API
- [ ] **3.3.1** POST `/api/photos`（バリデーション）【前提: 2.1.3, 2.3.3】

### 3.4 コメントAPI
- [ ] **3.4.1** GET `/api/comments`【前提: 2.1.4】
- [ ] **3.4.2** POST `/api/comments`【前提: 2.1.4】

### 3.5 いいねAPI
- [ ] **3.5.1** POST `/api/likes`【前提: 2.1.5】
- [ ] **3.5.2** DELETE `/api/likes`【前提: 2.1.5】

### 3.6 共通処理
- [ ] **3.6.1** `lib/apiClient.ts`作成【前提: 1.1.4】
- [ ] **3.6.2** Middleware認証保護【前提: 3.1.1, 3.1.2】

---
## 4. フロントエンド実装 (ID: 4)
### 4.1 共通レイアウト
- [ ] **4.1.1** `layout.tsx`構築【前提: 1.1.4, 1.1.5】
- [ ] **4.1.2** Material UIテーマ設定【前提: 4.1.1】

### 4.2 ページ作成
- [ ] **4.2.1** トップ `/`（地図表示）【前提: 1.1.6, 3.2.1】
- [ ] **4.2.2** 掲示板詳細モーダル【前提: 4.2.1, 3.2.1, 3.4.1】
- [ ] **4.2.3** 写真投稿 `/boards/upload`【前提: 3.3.1】
- [ ] **4.2.4** 認証ページ【前提: 3.1.1, 3.1.2】
- [ ] **4.2.5** プロフィールページ【前提: 2.1.1】

---
## 5. テスト・デバッグ (ID: 5)
- [ ] **5.1.1** API単体テスト【前提: 3.x】
- [ ] **5.1.2** UI確認テスト【前提: 4.x】
- [ ] **5.1.3** スマホ・PCブラウザ動作確認
- [ ] **5.1.4** 画像アップロード制限確認
- [ ] **5.1.5** 投稿制限（3日以内）検証

---
## 6. デプロイ (ID: 6)
- [ ] **6.1.1** Vercelデプロイ【前提: 4.x, 5.x】
- [ ] **6.1.2** Supabase環境変数設定
- [ ] **6.1.3** HTTPS/ドメイン設定

---
## 7. 運用・改善 (ID: 7)
- [ ] **7.1.1** 利用ログ収集（Supabase Logs）
- [ ] **7.1.2** 不適切投稿報告機能
- [ ] **7.1.3** 通知機能（コメント・いいね）
- [ ] **7.1.4** UI改善（Figma検討）
